# 常见的进程调度算法

在OS中，调度的实质是一种资源分配。

调度算法是指：根据系统资源分配策略所规定的资源分配算法。

对于不同的系统或系统目标，通常采用不同的调度算法。

## 先来先服务调度算法 

先来先服务(FCFS)调度算法是一种最简单的调度算法，该算法既可用于作业调度，也可用于进程调度。

当在作业调度中采用该算法时，每次调度都是从后备作业队列中选择一个或多个最先进入该队列的作业，将它们调入内存，为它们分配资源、创建进程，然后放入就绪队列。

在进程调度中采用FCFS算法时，则每次调度是从就绪队列中选择一个最先进入该队列的进程，为之分配处理机，使之投入运行。该进程一直运行到完成或发生某事件而阻塞后才放弃处理机。

## 短作业(进程)优先调度算法 

短作业(进程)优先调度算法SJ(P)F，是指对短作业或短进程优先调度的算法。它们可以分别用于作业调度和进程调度。

短作业优先(SJF)的调度算法是从后备队列中选择一个或若干个估计运行时间最短的作业，将它们调入内存运行。

而短进程优先(SPF)调度算法则是从就绪队列中选出一个估计运行时间最短的进程，将处理机分配给它，使它立即执行并一直执行到完成，或发生某事件而被阻塞放弃处理机时再重新调度。

## 高优先权优先调度算法

为了照顾紧迫型作业，使之在进入系统后便获得优先处理，引入了最高优先权(FPF)调度算法。

此算法常被用于批处理系统中，作为作业调度算法，也作为多种操作系统中的进程调度算法，还可用于实时系统中。

当把该算法用于作业调度时，系统将从后备队列中选择若干个优先权最高的作业装入内存。

当用于进程调度时，该算法是把处理机分配给就绪队列中优先权最高的进程，这时，又可进一步把该算法分成如下两种。 

- **非抢占式优先权算法** 

	在这种方式下，系统一旦把处理机分配给就绪队列中优先权最高的进程后，该进程便一直执行下去，直至完成；或因发生某事件使该进程放弃处理机时，系统方可再将处理机重新分配给另一优先权最高的进程。这种调度算法主要用于批处理系统中；也可用于某些对实时性要求不高的系统中。 
- **抢占式优先权调度算法**

	在这种方式下，系统同样是把处理机分配给优先权最高的进程，使之执行。但在其执行期间，只要又出现了另一个其优先权更高的进程，进程调度程序就立即停止当前进程(原优先权最高的进程)的执行，重新将处理机分配给新到的优先权最高的进程。
	
	因此，在采用这种调度算法时，是每当系统中出现一个新的就绪进程 i 时，就将其优先权 P<sub>i</sub> 与正在执行的进程 j 的优先权 P<sub>j</sub> 进行比较。如果 P<sub>i</sub> ≤ P<sub>j</sub>，原进程 P<sub>j</sub> 便继续执行；但如果是P<sub>i</sub> > P<sub>j</sub>，则立即停止 P<sub>j</sub> 的执行，做进程切换，使 j 进程投入执行。
	
	显然，这种抢占式的优先权调度算法能更好地满足紧迫作业的要求，故而常用于要求比较严格的实时系统中，以及对性能要求较高的批处理和分时系统中。

- **高响应比优先调度算法**
	
	该算法实际上是一种动态优先权调度算法，它以响应比作为作业或进程的动态优先权，其目的是既照顾短作业，又考虑到作业的等待时间，使长作业不会长期等待；但每次调度前，都要进行响应比计算，会增加系统开销。
	
	响应比 = 响应时间 / 要求服务时间 = （等待时间 + 要求服务时间）/ 要求服务时间
	
## 时间片轮转法 ##

在早期的时间片轮转法中，系统将所有的就绪进程按先来先服务的原则排成一个队列，每次调度时，把CPU分配给队首进程，并令其执行一个时间片。时间片的大小从几ms到几百ms。

当执行的时间片用完时，由一个计时器发出时钟中断请求，调度程序便据此信号来停止该进程的执行，并将它送往就绪队列的末尾；然后，再把处理机分配给就绪队列中新的队首进程，同时也让它执行一个时间片。这样就可以保证就绪队列中的所有进程在一给定的时间内均能获得一时间片的处理机执行时间。

换言之，系统能在给定的时间内响应所有用户的请求。

## 多级反馈队列调度算法 ##

多级反馈队列调度算法是一种CPU处理机调度算法，UNIX操作系统采取的便是这种调度算法。　　

多级反馈队列调度算法即能使高优先级的作业得到响应又能使短作业(进程)迅速完成。

多级(假设为N级)反馈队列调度算法可以如下原理：

1. 设有N个队列（Q1,Q2,...,QN），其中各个队列对于处理机的优先级是不一样的，也就是说位于各个队列中的作业(进程)的优先级也是不一样的。一般来说，优先级Priority(Q1) > Priority(Q2) > … > Priority(QN)。怎么讲，位于Q1中的任何一个作业(进程)都要比Q2中的任何一个作业(进程)相对于CPU的优先级要高（也就是说，Q1中的作业一定要比Q2中的作业先被处理机调度），依次类推其它的队列。
2. 对于某个特定的队列来说，里面是遵循时间片轮转法。也就是说，位于队列Q2中有M个作业，它们的运行时间是通过Q2这个队列所设定的时间片来确定的。
3. 各个队列的时间片是随着优先级的增加而减少的，也就是说，优先级越高的队列，它的时间片就越短。同时，为了便于那些超大作业的完成，最后一个队列QN(优先级最低的队列)的时间片一般很大。

多级反馈队列调度算法描述：

1. 进程在进入待调度的队列等待时，首先进入优先级最高的Q1等待。
2. 首先调度优先级高的队列中的进程。若高优先级队列中已没有待调度的进程，则调度次优先级队列中的进程。例如：Q1,Q2,Q3三个队列，只有在Q1中没有进程等待时才去调度Q2，同理，只有Q1,Q2都为空时才会去调度Q3。
3. 对于同一个队列中的各个进程，按照时间片轮转法调度。比如Q1队列的时间片为N，那么Q1中的作业在经历了N个时间片后若还没有完成，则进入Q2队列等待，若Q2的时间片用完后作业还不能完成，一直进入下一级队列，直至完成。　　
4. 在低优先级的队列中的进程在运行时，又有新到达的作业，那么在运行完这个时间片后（**而不是**等作业执行完这个队列分配给它的所有时间片），CPU马上分配给新到达的作业（抢占式）。　　
